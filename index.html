<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <title>Voter Registration App</title>
        <link href="static/favicon.ico" rel="icon" type="image/x-icon"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
        <link rel="stylesheet" href="static/leaflet-0.7.3/leaflet.css" />
        <script src="static/leaflet-0.7.3/leaflet.js"></script>
        <style>
            /*http://meyerweb.com/eric/tools/css/reset/ v2.0 | 20110126 License: none (public domain)*/
            html, body, div, span, applet, object, iframe, h1, h2, h3, h4, h5, h6, p, blockquote, pre, a, abbr, acronym, address, big, cite, code, del, dfn, em, img, ins, kbd, q, s, samp, small,
            strike, strong, sub, sup, tt, var, b, u, i, center, dl, dt, dd, ol, ul, li, fieldset, form, label, legend, table, caption, tbody, tfoot, thead, tr, th, td, article, aside, canvas,
            details, embed, figure, figcaption, footer, header, hgroup, menu, nav, output, ruby, section, summary, time, mark, audio, video {margin:0; padding:0; border:0; font-size:100%; font:inherit; vertical-align:baseline;}
            /* HTML5 display-role reset for older browsers */
            article, aside, details, figcaption, figure, footer, header, hgroup, menu, nav, section {display:block;} body {line-height: 1;} ol, ul {list-style: none;}
            blockquote, q {quotes: none;} blockquote:before, blockquote:after, q:before, q:after {content:''; content:none;} table {border-collapse:collapse; border-spacing:0;}

            html,body{height:100%;}
            #map{height:100%;}
        </style>
    </head>
    <body>
        <div id="map"></div>
        <script src="static/voter-registration.js"></script>
        <script>
            //Leaflet map init
            var defaultLatLng = [37.78746242830388, -122.39666998386383]; //Hackathon location
            var pin = new L.marker(defaultLatLng, {draggable: true});
            var map = L.map('map').setView(defaultLatLng, 10);
            L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
                attribution: "&copy; <a href='http://www.openstreetmap.org/copyright' target='_blank'>OpenStreetMap</a>"
            }).addTo(map);

            //Load state border
            var xhr = new XMLHttpRequest();
            xhr.open("GET", "static/geojson/tiger2014.state.ca.geo.json");
            xhr.overrideMimeType("application/json");
            xhr.onload = function(){
                var ca = L.GeoJSON.geometryToLayer(JSON.parse(this.responseText).features[0]);
                ca.setStyle({
                    color: "#F95252",
                    opacity: 0.5,
                    fill: false,
                });
                map.addLayer(ca);
            };
            xhr.send();

            //Load counties
            var xhr = new XMLHttpRequest();
            xhr.open("GET", "static/geojson/tiger2014.county.ca.geo.json");
            xhr.overrideMimeType("application/json");
            xhr.onload = function(){
                //Parse counties
                countyGeo = JSON.parse(this.responseText).features;
                for(var i = 0; i < countyGeo.length; i++)
                    addBoxes(countyGeo[i]);

                //Initialize the pin
                pin.on("drag", updatePin);
                pin.on("dragend", updatePin);
                map.on("click", updatePin);
                pin.addTo(map);
                updatePin({latlng: new L.latLng(defaultLatLng[0], defaultLatLng[1])});

            };
            xhr.send();
        </script>
    </body>
</html>
